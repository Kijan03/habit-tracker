<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Habit Tracker - ë‹¹ì‹ ì˜ ì„±ì¥ì„ ì‘ì›í•©ë‹ˆë‹¤</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Tailwind CSS JIT ì»´íŒŒì¼ëŸ¬ê°€ ë™ì  í´ë˜ìŠ¤ë¥¼ ì¸ì‹í•˜ë„ë¡ ë•ëŠ” ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        body {
            background-color: var(--bg-color, #f0f2f5);
            transition: background-color 0.3s ease;
        }
        .card {
            background-color: var(--card-bg-color, #ffffff);
        }
        .text-main {
            color: var(--text-color, #1f2937);
        }
        .text-secondary {
            color: var(--text-secondary-color, #6b7280);
        }
        .progress-bar-bg {
            background-color: var(--progress-bg-color, #e5e7eb);
        }
        .progress-bar-fill {
            background-color: var(--accent-color, #34d399);
        }
        .button-accent {
             background-color: var(--accent-color, #34d399);
        }
        .button-accent:hover {
            background-color: var(--accent-hover-color, #10b981);
        }
        .streak-text {
            color: var(--streak-color, #f59e0b);
        }
    </style>
</head>
<body class="text-main">

    <!-- 1. ìƒë‹¨ ê´‘ê³  ì˜ì—­ -->
    <div class="w-full bg-gray-200 text-center py-4 text-gray-500 text-sm">ê´‘ê³ ê°€ ë“¤ì–´ê°ˆ ì˜ì—­</div>

    <div class="container mx-auto max-w-2xl p-4 md:p-6">
        
        <!-- 2. í—¤ë”: ë‚ ì§œì™€ ì‘ì› ë¬¸êµ¬ -->
        <header class="text-center mb-8">
            <h1 id="today-date" class="text-xl font-semibold text-secondary"></h1>
            <p id="motivational-quote" class="text-2xl md:text-3xl font-bold mt-2 text-main"></p>
        </header>

        <main class="card shadow-lg rounded-2xl p-6 space-y-6">

            <!-- 3. ì „ì²´ ë‹¬ì„±ë¥  í”„ë¡œê·¸ë ˆìŠ¤ ë°” -->
            <div class="progress-section">
                <div class="flex justify-between items-center mb-1">
                    <span class="text-sm font-medium text-secondary">ì˜¤ëŠ˜ì˜ ë‹¬ì„±ë¥ </span>
                    <span id="progress-percentage" class="text-sm font-medium text-main">0%</span>
                </div>
                <div class="w-full progress-bar-bg rounded-full h-2.5">
                    <div id="progress-bar" class="progress-bar-fill h-2.5 rounded-full transition-all duration-500" style="width: 0%"></div>
                </div>
            </div>

            <!-- 4. ìŠµê´€ ì¶”ê°€ í¼ -->
            <form id="habit-form" class="flex gap-3">
                <input type="text" id="habit-input" placeholder="ìƒˆë¡œìš´ ìŠµê´€ ì¶”ê°€..." class="flex-grow bg-gray-100 border-2 border-transparent rounded-lg py-3 px-4 focus:outline-none focus:ring-2 focus:ring-green-400 focus:border-transparent text-main">
                <button type="submit" class="button-accent text-white font-bold py-3 px-6 rounded-lg transition-transform transform hover:scale-105">ì¶”ê°€</button>
            </form>

            <!-- 5. ìŠµê´€ ëª©ë¡ -->
            <ul id="habit-list" class="space-y-3">
                <!-- JSë¡œ ë™ì  ìƒì„± -->
            </ul>

        </main>
        
        <!-- 6. í…Œë§ˆ ë³€ê²½ -->
        <div class="card shadow-lg rounded-2xl p-4 mt-6">
            <h3 class="font-bold text-center mb-3 text-main">í…Œë§ˆ ìƒ‰ìƒ ë³€ê²½</h3>
            <div id="theme-switcher" class="flex justify-center gap-3">
                <button data-color="#f0f2f5" class="w-8 h-8 rounded-full bg-[#f0f2f5] border-2 border-gray-300"></button>
                <button data-color="#1f2937" class="w-8 h-8 rounded-full bg-[#1f2937] border-2"></button>
                <button data-color="#fefce8" class="w-8 h-8 rounded-full bg-[#fefce8] border-2"></button>
                <button data-color="#e0e7ff" class="w-8 h-8 rounded-full bg-[#e0e7ff] border-2"></button>
            </div>
        </div>

        <!-- 7. ìŠµê´€ í˜•ì„± íŒ -->
        <section class="card shadow-lg rounded-2xl p-6 mt-6">
            <h2 class="text-xl font-bold text-center mb-4 text-main">ìŠµê´€ í˜•ì„±ì— ë„ì›€ë˜ëŠ” íŒ</h2>
            <div class="text-secondary space-y-2">
                <p><strong>ì‘ê²Œ ì‹œì‘í•˜ì„¸ìš”:</strong> ì²˜ìŒë¶€í„° ë„ˆë¬´ í° ëª©í‘œë¥¼ ì„¸ìš°ì§€ ë§ˆì„¸ìš”. 'ë§¤ì¼ 1ì‹œê°„ ìš´ë™'ì´ ì•„ë‹Œ 'ë§¤ì¼ 10ë¶„ ì‚°ì±…'ìœ¼ë¡œ ì‹œì‘í•˜ëŠ” ê²ƒì´ ê¾¸ì¤€í•¨ì„ ìœ ì§€í•˜ëŠ” ë¹„ê²°ì…ë‹ˆë‹¤.</p>
                <p><strong>ê¸°ì¡´ ìŠµê´€ì— ë¶™ì´ì„¸ìš”:</strong> ìƒˆë¡œìš´ ìŠµê´€ì„ ì´ë¯¸ ê°€ì§€ê³  ìˆëŠ” ìŠµê´€ ë’¤ì— ë¶™ì—¬ë³´ì„¸ìš”. ì˜ˆë¥¼ ë“¤ì–´ 'ì–‘ì¹˜ í›„ ë°”ë¡œ ëª…ìƒí•˜ê¸°'ì²˜ëŸ¼ ì—°ê²°í•˜ë©´ ìŠì§€ ì•Šê³  ì‹¤ì²œí•˜ê¸° ì‰½ìŠµë‹ˆë‹¤.</p>
            </div>
        </section>

    </div>

    <!-- 8. í•˜ë‹¨ ê´‘ê³  ì˜ì—­ -->
    <div class="w-full bg-gray-200 text-center py-4 text-gray-500 text-sm mt-8">ê´‘ê³ ê°€ ë“¤ì–´ê°ˆ ì˜ì—­</div>


    <script>
    document.addEventListener('DOMContentLoaded', () => {
        // DOM ìš”ì†Œ
        const elements = {
            date: document.getElementById('today-date'),
            quote: document.getElementById('motivational-quote'),
            progressText: document.getElementById('progress-percentage'),
            progressBar: document.getElementById('progress-bar'),
            habitForm: document.getElementById('habit-form'),
            habitInput: document.getElementById('habit-input'),
            habitList: document.getElementById('habit-list'),
            themeSwitcher: document.getElementById('theme-switcher')
        };

        const STORAGE_KEY_HABITS = 'habitsDataV3';
        const STORAGE_KEY_THEME = 'themeColorV1';
        
        let state = {
            habits: [],
            lastVisitDate: getISODateString(new Date())
        };

        const quotes = [
            "ì„±ê³µì˜ ë¹„ê²°ì€ ì‹œì‘í•˜ëŠ” ê²ƒì´ë‹¤.", "ì˜¤ëŠ˜ì˜ ì‘ì€ ì‹¤ì²œì´ ë‚´ì¼ì˜ í° ë³€í™”ë¥¼ ë§Œë“ ë‹¤.", "ì–´ì œë³´ë‹¤ ë‚˜ì€ ì˜¤ëŠ˜ì„ ë§Œë“¤ì.", "ê¾¸ì¤€í•¨ì´ ë¹„ë²”í•¨ì„ ë§Œë“ ë‹¤.", "ê°€ì¥ í° ìœ„í—˜ì€ ì•„ë¬´ ìœ„í—˜ë„ ê°ìˆ˜í•˜ì§€ ì•ŠëŠ” ê²ƒì´ë‹¤."
        ];

        // --- ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ ---
        function getISODateString(date) {
            return date.getFullYear() + '-' + ('0' + (date.getMonth() + 1)).slice(-2) + '-' + ('0' + date.getDate()).slice(-2);
        }

        // --- ìƒíƒœ ê´€ë¦¬ ---
        const saveState = () => localStorage.setItem(STORAGE_KEY_HABITS, JSON.stringify(state));
        const loadState = () => JSON.parse(localStorage.getItem(STORAGE_KEY_HABITS));
        const saveTheme = (color) => localStorage.setItem(STORAGE_KEY_THEME, color);
        const loadTheme = () => localStorage.getItem(STORAGE_KEY_THEME);

        // --- ë Œë”ë§ ë° UI ì—…ë°ì´íŠ¸ ---
        function applyTheme(color) {
            const isDark = (color === '#1f2937');
            document.documentElement.style.setProperty('--bg-color', color);
            document.documentElement.style.setProperty('--card-bg-color', isDark ? '#2d3748' : '#ffffff');
            document.documentElement.style.setProperty('--text-color', isDark ? '#e2e8f0' : '#1f2937');
            document.documentElement.style.setProperty('--text-secondary-color', isDark ? '#a0aec0' : '#6b7280');
            document.documentElement.style.setProperty('--progress-bg-color', isDark ? '#4a5568' : '#e5e7eb');
        }

        const updateProgressBar = () => {
            const total = state.habits.length;
            const completed = state.habits.filter(h => h.completed).length;
            const percentage = total > 0 ? Math.round((completed / total) * 100) : 0;
            elements.progressBar.style.width = `${percentage}%`;
            elements.progressText.textContent = `${percentage}%`;
        };
        
        const renderHabits = () => {
            elements.habitList.innerHTML = '';
            if (state.habits.length === 0) {
                elements.habitList.innerHTML = `<p class="text-center text-secondary">ì•„ì§ ë“±ë¡ëœ ìŠµê´€ì´ ì—†ìŠµë‹ˆë‹¤. ì²« ìŠµê´€ì„ ì¶”ê°€í•´ë³´ì„¸ìš”!</p>`;
            } else {
                state.habits.forEach((habit, index) => {
                    const isCompleted = habit.completed;
                    const li = document.createElement('li');
                    li.className = `habit-item flex items-center p-4 rounded-lg transition-all ${isCompleted ? 'bg-green-100' : 'bg-gray-50'}`;
                    li.innerHTML = `
                        <div class="flex-grow flex items-center gap-3 cursor-pointer">
                            <input type="checkbox" ${isCompleted ? 'checked' : ''} class="w-6 h-6 rounded-md border-2 border-gray-300 text-green-500 focus:ring-0">
                            <span class="flex-grow ${isCompleted ? 'line-through text-gray-400' : 'text-main'}">${habit.name}</span>
                        </div>
                        <span class="streak-text font-bold text-sm mx-4">${habit.streak > 0 ? `ğŸ”¥ ${habit.streak}` : ''}</span>
                        <button class="delete-btn text-gray-400 hover:text-red-500 text-lg">&times;</button>
                    `;
                    
                    li.querySelector('input[type="checkbox"]').addEventListener('change', () => toggleHabit(index));
                    li.querySelector('.delete-btn').addEventListener('click', (e) => {
                        e.stopPropagation();
                        deleteHabit(index);
                    });
                    elements.habitList.appendChild(li);
                });
            }
            updateProgressBar();
        };

        function displayHeaderInfo() {
            const today = new Date();
            elements.date.textContent = today.toLocaleDateString('ko-KR', { year: 'numeric', month: 'long', day: 'numeric' });
            elements.quote.textContent = quotes[Math.floor(Math.random() * quotes.length)];
        }

        // --- í•µì‹¬ ë¡œì§ ---
        const addHabit = (name) => {
            if (name.trim() === '') return;
            state.habits.push({ name: name.trim(), completed: false, streak: 0, lastCompletedDate: null });
            saveState();
            renderHabits();
        };

        const toggleHabit = (index) => {
            const habit = state.habits[index];
            const today = getISODateString(new Date());
            const yesterday = getISODateString(new Date(Date.now() - 86400000));
            habit.completed = !habit.completed;
            if (habit.completed) {
                habit.streak = habit.lastCompletedDate === yesterday ? habit.streak + 1 : 1;
                habit.lastCompletedDate = today;
            } else {
                if (habit.lastCompletedDate === today) {
                    habit.streak--;
                    habit.lastCompletedDate = habit.streak > 0 ? yesterday : null;
                }
            }
            saveState();
            renderHabits();
        };

        const deleteHabit = (index) => {
            state.habits.splice(index, 1);
            saveState();
            renderHabits();
        };

        const initializeState = () => {
            const loaded = loadState();
            const today = getISODateString(new Date());
            const yesterday = getISODateString(new Date(Date.now() - 86400000));
            
            if (loaded) {
                state = loaded;
                if (state.lastVisitDate !== today) {
                    state.habits.forEach(habit => {
                        if (habit.lastCompletedDate !== yesterday) {
                            habit.streak = 0;
                        }
                        habit.completed = false;
                    });
                    state.lastVisitDate = today;
                }
            }
            saveState();
        };

        // --- ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ---
        elements.habitForm.addEventListener('submit', (e) => {
            e.preventDefault();
            addHabit(elements.habitInput.value);
            elements.habitInput.value = '';
        });

        elements.themeSwitcher.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                const color = e.target.dataset.color;
                applyTheme(color);
                saveTheme(color);
            }
        });

        // --- ì´ˆê¸°í™” ---
        function init() {
            const savedTheme = loadTheme();
            if (savedTheme) {
                applyTheme(savedTheme);
            } else {
                applyTheme('#f0f2f5'); // ê¸°ë³¸ í…Œë§ˆ
            }
            displayHeaderInfo();
            initializeState();
            renderHabits();
        }

        init();
    });
    </script>
</body>
</html>
